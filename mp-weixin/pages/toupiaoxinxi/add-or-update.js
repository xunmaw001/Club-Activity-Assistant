(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/toupiaoxinxi/add-or-update"],{"289d":function(e,t,r){"use strict";r.r(t);var n=r("6040"),i=r("7126");for(var o in i)"default"!==o&&function(e){r.d(t,e,(function(){return i[e]}))}(o);r("da87");var a,u=r("f0c5"),c=Object(u["a"])(i["default"],n["b"],n["c"],!1,null,"616111fc",null,!1,n["a"],a);t["default"]=c.exports},6040:function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return o})),r.d(t,"a",(function(){return n}));var n={wPicker:function(){return Promise.all([r.e("common/vendor"),r.e("components/w-picker/w-picker")]).then(r.bind(null,"baa7"))}},i=function(){var e=this,t=e.$createElement;e._self._c},o=[]},7126:function(e,t,r){"use strict";r.r(t);var n=r("b0bb"),i=r.n(n);for(var o in n)"default"!==o&&function(e){r.d(t,e,(function(){return n[e]}))}(o);t["default"]=i.a},"7df1":function(e,t,r){},b0bb:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r("a34a"));function i(e){return e&&e.__esModule?e:{default:e}}function o(e,t,r,n,i,o,a){try{var u=e[o](a),c=u.value}catch(s){return void r(s)}u.done?t(c):Promise.resolve(c).then(n,i)}function a(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var a=e.apply(t,r);function u(e){o(a,n,i,u,c,"next",e)}function c(e){o(a,n,i,u,c,"throw",e)}u(void 0)}))}}var u=function(){Promise.all([r.e("common/vendor"),r.e("components/w-picker/w-picker")]).then(function(){return resolve(r("baa7"))}.bind(null,r)).catch(r.oe)},c={data:function(){return{cross:"",ruleForm:{toupiaobianhao:this.getUUID(),toupiaobiaoti:"",fengmian:"",zhanghao:"",toupiaoshijian:"",toupiaojieguo:"",beizhu:"",crossuserid:"",crossrefid:"",userid:""},toupiaojieguoOptions:[],toupiaojieguoIndex:0,user:{},ro:{toupiaobianhao:!1,toupiaobiaoti:!1,fengmian:!1,zhanghao:!1,toupiaoshijian:!1,toupiaojieguo:!1,beizhu:!1,crossuserid:!1,crossrefid:!1,clicktime:!1,clicknum:!1,userid:!1}}},components:{wPicker:u},computed:{baseUrl:function(){return this.$base.url}},onLoad:function(t){var r=this;return a(n.default.mark((function i(){var o,a,u,c;return n.default.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return r.ruleForm.toupiaoshijian=r.$utils.getCurDateTime(),o=e.getStorageSync("nowTable"),i.next=4,r.$api.session(o);case 4:if(a=i.sent,r.user=a.data,r.ruleForm.zhanghao=r.user.zhanghao,r.ro.zhanghao=!0,r.toupiaojieguoOptions="选项a,选项b,选项c,选项d".split(","),r.ruleForm.userid=e.getStorageSync("userid"),t.refid&&(r.ruleForm.refid=t.refid,r.ruleForm.nickname=e.getStorageSync("nickname")),!t.id){i.next=17;break}return r.ruleForm.id=t.id,i.next=15,r.$api.info("toupiaoxinxi",r.ruleForm.id);case 15:a=i.sent,r.ruleForm=a.data;case 17:if(r.cross=t.cross,!t.cross){i.next=73;break}u=e.getStorageSync("crossObj"),i.t0=n.default.keys(u);case 21:if((i.t1=i.t0()).done){i.next=73;break}if(c=i.t1.value,"toupiaobianhao"!=c){i.next=27;break}return r.ruleForm.toupiaobianhao=u[c],r.ro.toupiaobianhao=!0,i.abrupt("continue",21);case 27:if("toupiaobiaoti"!=c){i.next=31;break}return r.ruleForm.toupiaobiaoti=u[c],r.ro.toupiaobiaoti=!0,i.abrupt("continue",21);case 31:if("fengmian"!=c){i.next=35;break}return r.ruleForm.fengmian=u[c],r.ro.fengmian=!0,i.abrupt("continue",21);case 35:if("zhanghao"!=c){i.next=39;break}return r.ruleForm.zhanghao=u[c],r.ro.zhanghao=!0,i.abrupt("continue",21);case 39:if("toupiaoshijian"!=c){i.next=43;break}return r.ruleForm.toupiaoshijian=u[c],r.ro.toupiaoshijian=!0,i.abrupt("continue",21);case 43:if("toupiaojieguo"!=c){i.next=47;break}return r.ruleForm.toupiaojieguo=u[c],r.ro.toupiaojieguo=!0,i.abrupt("continue",21);case 47:if("beizhu"!=c){i.next=51;break}return r.ruleForm.beizhu=u[c],r.ro.beizhu=!0,i.abrupt("continue",21);case 51:if("crossuserid"!=c){i.next=55;break}return r.ruleForm.crossuserid=u[c],r.ro.crossuserid=!0,i.abrupt("continue",21);case 55:if("crossrefid"!=c){i.next=59;break}return r.ruleForm.crossrefid=u[c],r.ro.crossrefid=!0,i.abrupt("continue",21);case 59:if("clicktime"!=c){i.next=63;break}return r.ruleForm.clicktime=u[c],r.ro.clicktime=!0,i.abrupt("continue",21);case 63:if("clicknum"!=c){i.next=67;break}return r.ruleForm.clicknum=u[c],r.ro.clicknum=!0,i.abrupt("continue",21);case 67:if("userid"!=c){i.next=71;break}return r.ruleForm.userid=u[c],r.ro.userid=!0,i.abrupt("continue",21);case 71:i.next=21;break;case 73:r.styleChange();case 74:case"end":return i.stop()}}),i)})))()},methods:{styleChange:function(){this.$nextTick((function(){}))},toupiaoshijianConfirm:function(e){console.log(e),this.ruleForm.toupiaoshijian=e.result,this.$forceUpdate()},clicktimeConfirm:function(e){console.log(e),this.ruleForm.clicktime=e.result,this.$forceUpdate()},toupiaojieguoChange:function(e){this.toupiaojieguoIndex=e.target.value,this.ruleForm.toupiaojieguo=this.toupiaojieguoOptions[this.toupiaojieguoIndex]},fengmianTap:function(){var e=this;this.$api.upload((function(t){e.ruleForm.fengmian="upload/"+t.file,e.$forceUpdate(),e.$nextTick((function(){e.styleChange()}))}))},getUUID:function(){return(new Date).getTime()},onSubmitTap:function(){var t=this;return a(n.default.mark((function r(){var i,o,a,u,c,s,l,f,d,p;return n.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(t.ruleForm.toupiaobiaoti){r.next=3;break}return t.$utils.msg("投票标题不能为空"),r.abrupt("return");case 3:if(!t.ruleForm.clicknum||t.$validate.isIntNumer(t.ruleForm.clicknum)){r.next=6;break}return t.$utils.msg("点击次数应输入整数"),r.abrupt("return");case 6:if(!t.cross){r.next=22;break}if(u=e.getStorageSync("statusColumnName"),c=e.getStorageSync("statusColumnValue"),""==u){r.next=22;break}if(s=e.getStorageSync("crossObj"),u.startsWith("[")){r.next=18;break}for(l in s)l==u&&(s[l]=c);return f=e.getStorageSync("crossTable"),r.next=16,t.$api.update("".concat(f),s);case 16:r.next=22;break;case 18:i=Number(e.getStorageSync("userid")),o=s["id"],a=e.getStorageSync("statusColumnName"),a=a.replace(/\[/,"").replace(/\]/,"");case 22:if(!o||!i){r.next=44;break}return t.ruleForm.crossuserid=i,t.ruleForm.crossrefid=o,d={page:1,limit:10,crossuserid:i,crossrefid:o},r.next=28,t.$api.list("toupiaoxinxi",d);case 28:if(p=r.sent,!(p.data.total>=a)){r.next=34;break}return t.$utils.msg(e.getStorageSync("tips")),r.abrupt("return",!1);case 34:if(!t.ruleForm.id){r.next=39;break}return r.next=37,t.$api.update("toupiaoxinxi",t.ruleForm);case 37:r.next=41;break;case 39:return r.next=41,t.$api.add("toupiaoxinxi",t.ruleForm);case 41:t.$utils.msgBack("提交成功");case 42:r.next=52;break;case 44:if(!t.ruleForm.id){r.next=49;break}return r.next=47,t.$api.update("toupiaoxinxi",t.ruleForm);case 47:r.next=51;break;case 49:return r.next=51,t.$api.add("toupiaoxinxi",t.ruleForm);case 51:t.$utils.msgBack("提交成功");case 52:case"end":return r.stop()}}),r)})))()},optionsChange:function(e){this.index=e.target.value},bindDateChange:function(e){this.date=e.target.value},getDate:function(e){var t=new Date,r=t.getFullYear(),n=t.getMonth()+1,i=t.getDate();return"start"===e?r-=60:"end"===e&&(r+=2),n=n>9?n:"0"+n,i=i>9?i:"0"+i,"".concat(r,"-").concat(n,"-").concat(i)},toggleTab:function(e){this.$refs[e].show()}}};t.default=c}).call(this,r("543d")["default"])},c9d2:function(e,t,r){"use strict";(function(e){r("cb25");n(r("66fd"));var t=n(r("289d"));function n(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=r,e(t.default)}).call(this,r("543d")["createPage"])},da87:function(e,t,r){"use strict";var n=r("7df1"),i=r.n(n);i.a}},[["c9d2","common/runtime","common/vendor"]]]);